# 11章　ツール：エコシステムの概要
4章で説明した定義にチーム同士の関係についてのコンテキストを追加し理解を深める。(４章と被るのでチームに関するところをかいつまんで)

## ソフトウェア開発
プログラミング、ドキュメント作成、テスト、バグ修正の仕事を進めやすくしてくれる。

### ローカル開発環境
- 作業をすぐに社員に初めてほしいなら、統一したローカル開発環境の整備がとても重要だ
- 統一的なエクスペリエンスを保障することと、それぞれのニーズに合わせて作業端末や作業習慣をカスタマイズすることとの間では、適切にバランスを取る必要がある
- 近年は社員が自分のやり方で仕事を進められるようにすることが以前よりも重視されている
- ローカル開発環境の共通部分を明確にしてドキュメント化する
    - 時間かけて使い込むとツールの使い方は上達してくる
    - 細かい部分を念入りに説明するのではなく、初心者がその環境の中で成功に向かってスタートを切れることを目標にするべき

### バージョン管理
- いわずもがな

### アーティファクト管理
- ソフトウェアのバージョン管理とは別に、アーティファクトとしてバージョンをつけて共通ライブラリを格納する
    - 全てのチームが同じ共有ライブラリを使えるようになる
    - バイナリは1度だけビルドすることで、ビルドからテストまで必ず同じバイナリが使われることが保障でき、複雑さを緩和できる
- ローカル開発環境は、他のビルドやデプロイメカニズムと同じように、アーティファクトリポジトリにアクセスすることが望ましい
    - 「私の端末では動くのに」症候群を減らすことができる


## 自動化

### サーバーのインストール
- Linuxの中にはCobber/KickstartのようなOSのインストールを自動化するツールを提供しているものがある

### インフラストラクチャーの自動化
- インフラの自動化は、首尾一貫して、反復可能で、ドキュメントがしっかりしていて監査に対応でき、回復力の強いプロセスを導く
- 時間がかからなくなり、スタッフの作業効率が上がり、柔軟性が上がり、リスク計測がしやすくなる
- Infra as Codeにはこのように目に見えるメリットが多いので、企業が文化的な改革を進めるために最初に投資するツールの一つになることが多い
    - ツールを使おうとする特定の環境のコンテキストを踏まえなければ、ツールのことは理解できない
    - 特定の文化や環境に対する考え方がツールの効果に影響を及ぼすことがある

### システムのプロビジョニング
- 今はクラウドインフラに投資するというオプションがある
- システムのクラスタ単位でインフラを定義できる
    - あとで何度でもサーバーグループをプロビジョニングできる

### テストとビルドの自動化
- 自動化の種類
    - オンデマンド、スケジュール、トリガー
- テストに関連するその他の用語
    - スモークテスト、リグレッションテスト、ユーザビリティテスト、A/Bテスト、ブルーグリーンデプロイ、カナリアプロセス

## モニタリング
- 情報収集の方法としてメトリクスの計測とログがある
- システムレベル
    - サーバーの稼働有無、メモリ／CPU／ディスクなど
- アプリケーションレベル
    - ウェブサーバが受けるトラフィック、キューイングシステムの待ち数、ページロード時間、Slow Queryなど
- かつてはシステム／NW管理者の専門領域だったが、ソフトウェアが複雑になり、チームのコラボレーションが盛んになるにつれて、重要な存在だということが認識されるようになってきた

### メトリクス
- 定性的、定量的な計測結果のコレクション
    - 何らかのベンチマークや標準と比較され、分析や履歴管理のために追跡管理される
- メトリクスは職能組織の中でサイロ化されることが多い
    - それでは製品開発の正しい方向性の選択に影響を及ぼす
- チームによって異なるメトリクスを管理し、それぞれの仕事に生かして良い
- StatsDとGraphiteは広く使われている

### ロギング
- 重要

### アラート
- 影響
    - アラート疲れを防ぐために、アラートは大きな影響を与えるインシデントだけに制限すべき
- 緊急性
    - 何が緊急かは全てのステークホルダーのことを考えることが大切
- 当事者
    - インシデントに対応すべき人にアラートを送る
    - DBの問題でDBAしか対応できないものなど
- リソース
    - 特定のインシデントに対応するためのリソースが十分か
    - オンコール担当者が単一障害点になっていないか
- コスト
    - モニタリングサービスのコスト
    - 過去のアラートを格納するストレージコスト
    - アラート送信コスト
    - インシデント対応コスト
    - サービスが利用不能になった場合のコスト、など

### イベント
- 定義されたメトリクスにおいて、閾値を超えたりアラート条件が満たされること
- Nagoisなどのシステムは自動イベントハンドラを備える
    - 自動再起動やディスク交換のチケット作成など
    - 運用スタッフが夜中に起こされる回数を大幅に削減できる
- 自動ハンドラにもリスクがある
    - エラー条件を明確に定義すること
    - プロセスを自動化できる程度にまでよく理解すること
    - 自動化が解決するより大きな問題を引き起こさないようにするための安全施策を施すこと
- アラートシステムの効率を上げるための努力を続けることが大切
    - 偽陽性
        - 狼アラート
        - 多すぎるとアラートへの不感症、燃え尽きの原因になるだけでなく、実際の問題への対処を遅らせることもある
    - 偽陰性
        - インシデントが起きてるのにアラートを生成しないこと
    - ソフトウェアの変化によりかつては問題だったのものが問題ではなくなることがある

## エコシステムの発展
- サーバ／インフラの自動化に至るまで、ヒューマンエラーの原因となる反復作業を単純化し、取り除こうとする動きがある
- コンテナの導入により開発端末から本番までのパイプラインはさらに単純化された
- CI/CDは、何が重要かを考えることから人間を解放した
- などなど

## まとめ
- ツールエコシステムの概要でした
- devopsツールは「私」よりも「私たち」を強調する
    - ツールの選択は、共通言語の選択
